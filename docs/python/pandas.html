<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Using PyArrow with pandas &#8212; pyarrow  documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reading and Writing the Apache Parquet Format" href="parquet.html" />
    <link rel="prev" title="Filesystem Interfaces" href="filesystems.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="parquet.html" title="Reading and Writing the Apache Parquet Format"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="filesystems.html" title="Filesystem Interfaces"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyarrow  documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Using PyArrow with pandas</a><ul>
<li><a class="reference internal" href="#dataframes">DataFrames</a></li>
<li><a class="reference internal" href="#series">Series</a></li>
<li><a class="reference internal" href="#type-differences">Type differences</a><ul>
<li><a class="reference internal" href="#pandas-arrow-conversion">pandas -&gt; Arrow Conversion</a></li>
<li><a class="reference internal" href="#arrow-pandas-conversion">Arrow -&gt; pandas Conversion</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="filesystems.html"
                        title="previous chapter">Filesystem Interfaces</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="parquet.html"
                        title="next chapter">Reading and Writing the Apache Parquet Format</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pandas.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="using-pyarrow-with-pandas">
<h1>Using PyArrow with pandas<a class="headerlink" href="#using-pyarrow-with-pandas" title="Permalink to this headline">¶</a></h1>
<p>To interface with pandas, PyArrow provides various conversion routines to
consume pandas structures and convert back to them.</p>
<div class="section" id="dataframes">
<h2>DataFrames<a class="headerlink" href="#dataframes" title="Permalink to this headline">¶</a></h2>
<p>The equivalent to a pandas DataFrame in Arrow is a <code class="xref py py-class docutils literal"><span class="pre">pyarrow.table.Table</span></code>.
Both consist of a set of named columns of equal length. While pandas only
supports flat columns, the Table also provides nested columns, thus it can
represent more data than a DataFrame, so a full conversion is not always possible.</p>
<p>Conversion from a Table to a DataFrame is done by calling
<code class="xref py py-meth docutils literal"><span class="pre">pyarrow.table.Table.to_pandas()</span></code>. The inverse is then achieved by using
<code class="xref py py-meth docutils literal"><span class="pre">pyarrow.Table.from_pandas()</span></code>. This conversion routine provides the
convience parameter <code class="docutils literal"><span class="pre">timestamps_to_ms</span></code>. Although Arrow supports timestamps of
different resolutions, pandas only supports nanosecond timestamps and most
other systems (e.g. Parquet) only work on millisecond timestamps. This parameter
can be used to already do the time conversion during the pandas to Arrow
conversion.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyarrow</span> <span class="kn">as</span> <span class="nn">pa</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="c1"># Convert from pandas to Arrow</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="c1"># Convert back to pandas</span>
<span class="n">df_new</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="series">
<h2>Series<a class="headerlink" href="#series" title="Permalink to this headline">¶</a></h2>
<p>In Arrow, the most similar structure to a pandas Series is an Array.
It is a vector that contains data of the same type as linear memory. You can
convert a pandas Series to an Arrow Array using <code class="xref py py-meth docutils literal"><span class="pre">pyarrow.array.from_pandas_series()</span></code>.
As Arrow Arrays are always nullable, you can supply an optional mask using
the <code class="docutils literal"><span class="pre">mask</span></code> parameter to mark all null-entries.</p>
</div>
<div class="section" id="type-differences">
<h2>Type differences<a class="headerlink" href="#type-differences" title="Permalink to this headline">¶</a></h2>
<p>With the current design of pandas and Arrow, it is not possible to convert all
column types unmodified. One of the main issues here is that pandas has no
support for nullable columns of arbitrary type. Also <code class="docutils literal"><span class="pre">datetime64</span></code> is currently
fixed to nanosecond resolution. On the other side, Arrow might be still missing
support for some types.</p>
<div class="section" id="pandas-arrow-conversion">
<h3>pandas -&gt; Arrow Conversion<a class="headerlink" href="#pandas-arrow-conversion" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Source Type (pandas)</th>
<th class="head">Destination Type (Arrow)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">bool</span></code></td>
<td><code class="docutils literal"><span class="pre">BOOL</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">(u)int{8,16,32,64}</span></code></td>
<td><code class="docutils literal"><span class="pre">(U)INT{8,16,32,64}</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">float32</span></code></td>
<td><code class="docutils literal"><span class="pre">FLOAT</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">float64</span></code></td>
<td><code class="docutils literal"><span class="pre">DOUBLE</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">str</span></code> / <code class="docutils literal"><span class="pre">unicode</span></code></td>
<td><code class="docutils literal"><span class="pre">STRING</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">pd.Categorical</span></code></td>
<td><code class="docutils literal"><span class="pre">DICTIONARY</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">pd.Timestamp</span></code></td>
<td><code class="docutils literal"><span class="pre">TIMESTAMP(unit=ns)</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">datetime.date</span></code></td>
<td><code class="docutils literal"><span class="pre">DATE</span></code></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="arrow-pandas-conversion">
<h3>Arrow -&gt; pandas Conversion<a class="headerlink" href="#arrow-pandas-conversion" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Source Type (Arrow)</th>
<th class="head">Destination Type (pandas)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">BOOL</span></code></td>
<td><code class="docutils literal"><span class="pre">bool</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">BOOL</span></code> <em>with nulls</em></td>
<td><code class="docutils literal"><span class="pre">object</span></code> (with values <code class="docutils literal"><span class="pre">True</span></code>, <code class="docutils literal"><span class="pre">False</span></code>, <code class="docutils literal"><span class="pre">None</span></code>)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">(U)INT{8,16,32,64}</span></code></td>
<td><code class="docutils literal"><span class="pre">(u)int{8,16,32,64}</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">(U)INT{8,16,32,64}</span></code> <em>with nulls</em></td>
<td><code class="docutils literal"><span class="pre">float64</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">FLOAT</span></code></td>
<td><code class="docutils literal"><span class="pre">float32</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">DOUBLE</span></code></td>
<td><code class="docutils literal"><span class="pre">float64</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">STRING</span></code></td>
<td><code class="docutils literal"><span class="pre">str</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">DICTIONARY</span></code></td>
<td><code class="docutils literal"><span class="pre">pd.Categorical</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">TIMESTAMP(unit=*)</span></code></td>
<td><code class="docutils literal"><span class="pre">pd.Timestamp</span></code> (<code class="docutils literal"><span class="pre">np.datetime64[ns]</span></code>)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">DATE</span></code></td>
<td><code class="docutils literal"><span class="pre">pd.Timestamp</span></code> (<code class="docutils literal"><span class="pre">np.datetime64[ns]</span></code>)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="parquet.html" title="Reading and Writing the Apache Parquet Format"
             >next</a> |</li>
        <li class="right" >
          <a href="filesystems.html" title="Filesystem Interfaces"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyarrow  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2017 Apache Software Foundation.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.5.
    </div>
  </body>
</html>